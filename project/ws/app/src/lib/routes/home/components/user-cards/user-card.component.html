<div class="searchfilter" *ngIf="!isApprovals">
  <ws-app-searchuser (handleApiData)="onSearch($event)" (handleapproveAll)="onApproveALL()"
    [showApproveALL]="showApproveALL"></ws-app-searchuser>
</div>

<div *ngIf="!isApprovals">
  <mat-accordion [multi]="true">
    <mat-expansion-panel class="user-card" *ngFor="let user of usersData?.content" #panel
      (opened)="closeOtherPanels(panel)">
      <mat-expansion-panel-header (click)="getUerData(user)">
        <div class="float-left width88" (click)="$event.stopPropagation();">
          <div class="initialcircle display-inline-block margin-right-m">
            <!-- <span>AB</span> -->
            <ws-widget-avatar-photo [name]="getUseravatarName(user)" [photoUrl]="user?.photo" size="l">
            </ws-widget-avatar-photo>
          </div>
          <div class="username display-inline-block">
            <div class="mat-subheading-2 margin-remove"
              *ngIf="user?.profileDetails && user?.profileDetails?.personalDetails">
              {{user?.profileDetails?.personalDetails?.firstname}}
              <span class="status-label margin-left-s verified"
                *ngIf="user?.profileDetails?.profileStatus === 'VERIFIED'">Verified
                <mat-icon>check_circle</mat-icon></span>
              <span class="status-label margin-left-s nonverified"
                *ngIf="user?.profileDetails?.profileStatus === 'NOT-VERIFIED'">Non-verified
                <mat-icon>check_circle</mat-icon></span>
            </div>

            <div class="mat-subheading-2 display-inline-block margin-remove" *ngIf="!user?.profileDetails">
              {{user?.firstName}}
            </div>
            <div class="mat-body-2 ws-mat-black40-text">{{user?.profileDetails &&
              user?.profileDetails?.professionalDetails
              &&
              user?.profileDetails?.professionalDetails?.designation ?
              user?.profileDetails?.professionalDetails?.designation : '-'}}</div>
            <div class="mat-caption ws-mat-black40-text" *ngIf="user?.profileDetails?.profileStatus === 'VERIFIED'">
              Verified on: {{user?.profileDetails?.profileStatusVerifiedOn | date: 'dd/MM/yyyy'}}</div>
          </div>
        </div>
        <div class="float-right">
          <div class="button margin-top-m mat-body" (click)="onEditUser(user);$event.stopPropagation();"
            *ngIf="isMdoAdmin || isMdoLeader">
            <mat-icon>edit</mat-icon> Edit
          </div>
        </div>
      </mat-expansion-panel-header>

      <div class="panel-body profile-box" *ngIf="user?.enableEdit">
        <form [formGroup]="updateUserDataForm" class="margin-top-m">
          <div class="inner-body">
            Primary Details <mat-icon class="ws-mat-black40-text custominfo">info_outline</mat-icon>
            <p class="float-right mat-body-2" *ngIf="user?.profileDetails?.profileStatus === 'VERIFIED'">
              <mat-slide-toggle>Mark this user as non-verified</mat-slide-toggle>
            </p>
            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label required">Group</label>
                <mat-form-field appearance="outline">
                  <mat-select #group formControlName="group" i18n-placeholder placeholder="Select group">
                    <mat-option [value]="g" *ngFor="let g of groupsList">
                      {{g}}
                    </mat-option>
                  </mat-select>
                  <mat-error [hidden]="false" i18n="Group Error | Explains group is required"
                    *ngIf="updateUserDataForm?.controls['group'].errors?.required">
                    Group is mandatory
                  </mat-error>
                </mat-form-field>
                <mat-icon class="verified-icon margin-left-xs"
                  *ngIf="user?.profileDetails?.profileStatus === 'VERIFIED'">
                  check_circle</mat-icon>
                <mat-icon class="nonverified-icon margin-left-xs"
                  *ngIf="user?.profileDetails?.profileStatus === 'NOT-VERIFIED'">
                  check_circle</mat-icon>
              </div>
              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label required">Designation</label>
                <mat-form-field appearance="outline">
                  <mat-select #designation formControlName="designation" i18n-placeholder
                    placeholder="Select designation"
                    (selectionChange)="otherDropDownChange(designation?.value, 'designation')">
                    <mat-option [value]="designation?.name" *ngFor="let designation of designationsMeta">
                      {{designation?.name}}
                    </mat-option>
                    <mat-option [value]="'Other'">Other</mat-option>
                  </mat-select>
                  <mat-error [hidden]="false" i18n="Designation Error | Explains designation is required"
                    *ngIf="updateUserDataForm?.controls['designation'].errors?.required">
                    Designation is mandatory
                  </mat-error>
                </mat-form-field>
                <mat-icon class="verified-icon margin-left-xs"
                  *ngIf="user?.profileDetails?.profileStatus === 'VERIFIED'">
                  check_circle</mat-icon>
                <mat-icon class="nonverified-icon margin-left-xs"
                  *ngIf="user?.profileDetails?.profileStatus === 'NOT-VERIFIED'">
                  check_circle</mat-icon>
              </div>
            </div>
          </div>
          <hr>
          <div class="inner-body">
            Other Details <mat-icon class="ws-mat-black40-text custominfo">info_outline</mat-icon>

            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label">Employee ID</label>
                <mat-form-field appearance="outline">
                  <input type="text" matInput #employeeID formControlName="employeeID">
                </mat-form-field>
              </div>

              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label required">Email</label>
                <mat-form-field appearance="outline">
                  <input id="primaryEmail" name="primaryEmailField" type="email" matInput placeholder="Type here"
                    #primaryEmail formControlName="primaryEmail" i18n-aria-label
                    aria-label="Primary Email readonly input" maxlength="320">
                  <mat-error [hidden]="false" i18n="Primary Email Error|Explains name is required"
                    *ngIf="updateUserDataForm?.controls['mobile'].errors?.required">
                    Email is mandatory
                  </mat-error>
                  <mat-error [hidden]="false" class="custom-error"
                    *ngIf="updateUserDataForm?.controls['mobile'].errors?.pattern" i18n-aria-label
                    aria-label="Please enter a valid email">
                    Please enter a valid email
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label required">Mobile number</label>
                <mat-form-field appearance="outline" class="w82 mobile-country-code">
                  <mat-select formControlName="countryCode" default="+91" i18n-placeholder placeholder="Select code"
                    i18n-aria-label aria-label="Mobile Number label">
                    <mat-option [value]="code" *ngFor="let code of countryCodes">{{code}}</mat-option>
                  </mat-select>
                </mat-form-field>
                <mat-form-field appearance="outline" class="flex-expand w-48p">
                  <input id="mobileNumber" #mobile type="text" matInput placeholder="Type here" formControlName="mobile"
                    i18n-aria-label aria-label="Mobile Number input" maxlength="10" (keypress)="numericOnly($event)"
                    (paste)="numericOnly($event)">
                  <mat-error [hidden]="false" i18n="Mobile Number Error | Explains Mobile no is required"
                    *ngIf="updateUserDataForm?.controls['mobile'].errors?.required" i18n-aria-label
                    aria-label="Please enter your mobile number">
                    Please enter your mobile number
                  </mat-error>
                  <mat-error [hidden]="false" *ngIf="updateUserDataForm?.controls['mobile'].errors?.pattern"
                    i18n-aria-label aria-label="Please enter a valid 10 digit mobile number">
                    Please enter a valid 10 digit mobile number
                  </mat-error>
                </mat-form-field>
                <!-- <div class="flex m-auto" *ngIf="isMobileVerified">
                  <mat-icon class="ws-mat-green-text margin-xs" svgIcon="verified"></mat-icon>
                </div> -->
                <!-- <div *ngIf="!isMobileVerified" class="flex flex-1">
                  <button *ngIf="!otpSend" mat-raised-button type="button" (click)="sendOtp()"
                    class="text-white btn-success btn-responsive" [disabled]="updateUserDataForm?.mobile?.invalid">
                    <a class="text-white" i18n>
                      Send OTP
                    </a>
                  </button>
                  <div *ngIf="otpSend" class="flex flex-1 flex-column">
                    <div class="flex flex-1 flex-row margin-bottom-m">
                      <mat-form-field appearance="outline" class="margin-top-xs flex-expand w-minus-w50">
                        <input id="mobileNumber" #otp type="number" matInput placeholder="Enter OTP" i18n-aria-label
                          aria-label="OTP input" onKeyPress="if(this.value.length === 8) return false;">
                        <mat-hint *ngIf="timeLeftforOTP > 0 ">
                          <span>Resend OTP after {{timeLeftforOTP | pipeDurationTransform:
                            'hms2M'}}</span>
                        </mat-hint>
                        <mat-hint *ngIf="timeLeftforOTP <= 0 ">
                          <span class="cursor-pointer ws-mat-default-text" (click)="resendOTP()">
                            Resend OTP
                          </span>
                        </mat-hint>
                      </mat-form-field>
                      <button mat-raised-button type="button" (click)="verifyOtp(otp)"
                        class="text-white btn-success btn-responsive margin-top-s otp"
                        [disabled]="updateUserDataForm?.mobile?.invalid  || disableVerifyBtn">
                        <span class="text-white" i18n>
                          Verify OTP
                        </span>
                      </button>
                    </div>
                  </div>
                </div> -->
              </div>
            </div>
            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label required">Date of Birth</label>
                <mat-form-field appearance="outline" class="customdob">
                  <input id="birthDate" matInput #dob formControlName="dob" [matDatepicker]="picker" i18n-placeholder
                    (focus)="picker.open()" placeholder="Choose date of birth" [min]="1/1/1900" [max]="today">
                  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker #picker (closed)="dob.blur()" i18n-aria-label aria-label="Date picker">
                  </mat-datepicker>
                  <mat-error [hidden]="false" i18n="Date of Birth Error | Explains name is required">
                    Date of birth is mandatory
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label required">Mother Tongue</label>
                <mat-form-field appearance="outline">
                  <input id="language" matInput type="text" placeholder="Type here" i18n-placeholder="Mother Tongue"
                    formControlName="domicileMedium" [matAutocomplete]="motherTongueAuto" i18n-aria-label
                    aria-label="Domicile Medium (Mother Tongue)" #motherTongue maxlength="30" />
                  <!-- <mat-error *ngIf="updateUserDataForm?.controls['domicileMedium'].errors?.forbiddenNames"
                    i18n-aria-label aria-label="Please choose a value from the list provided above.">
                    Please choose a value from the list provided above
                  </mat-error> -->
                  <mat-error [hidden]="false" i18n="domicileMedium Error|Explains Domicile Medium is required"
                    *ngIf="updateUserDataForm?.controls['domicileMedium'].errors?.required" i18n-aria-label
                    aria-label="Domicile Medium is mandatory">
                    Mother Tongue is mandatory
                  </mat-error>
                </mat-form-field>
                <mat-autocomplete #motherTongueAuto="matAutocomplete" autoActiveFirstOption="true">
                  <mat-option *ngFor="let option of masterLanguages | async" [value]="option.name">
                    {{ option.name }}
                  </mat-option>
                </mat-autocomplete>
              </div>

              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label required">Gender</label>
                <mat-form-field appearance="outline">
                  <mat-select #gender formControlName="gender" i18n-placeholder placeholder="Select gender">
                    <mat-option [value]="gender" *ngFor="let gender of genderList">
                      {{gender}}
                    </mat-option>
                  </mat-select>
                  <mat-error [hidden]="false" i18n="Gender Error | Explains gender is required">
                    Gender is mandatory
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label required">Office Pin Code</label>
                <mat-form-field appearance="outline">
                  <input id="pinCode" #pincode type="text" matInput placeholder="Type here" formControlName="pincode"
                    i18n-aria-label aria-label="Pin Code input field" autocomplete="off"
                    (keypress)="numericOnly($event)" maxlength="6">
                  <mat-error [hidden]="false" i18n="Pin code | Explains pin code is required">
                    Pin code is mandatory
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label">eHRMS ID</label>
                <mat-form-field appearance="outline">
                  <input type="text" matInput #ehrmsID formControlName="ehrmsID" placeholder="Type here">
                </mat-form-field>
              </div>

              <div class="md:w-1/3">
                <label class="margin-remove-bottom form-label required">Category</label>
                <mat-form-field appearance="outline">
                  <mat-select #category formControlName="category" i18n-placeholder placeholder="Select category">
                    <mat-option [value]="ctg" *ngFor="let ctg of categoryList">
                      {{ctg}}
                    </mat-option>
                  </mat-select>
                  <mat-error [hidden]="false" i18n="Category Error | Explains category is required">
                    Category is mandatory
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/2">
                <label class="margin-remove-bottom form-label">Tags</label>
                <!-- <mat-form-field> -->
                <div class="left-input-div">
                  <div class="flex-col">
                    <input class="appr-text-field w-full-imp" #tags matInput i18n-placeholder="Type here"
                      placeholder="Type here" formControlName="tags" i18n-aria-label aria-label="Type here"
                      [matChipInputFor]="chipListTags" autocomplete="off" maxlength="100"
                      [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                      (matChipInputTokenEnd)="addActivity($event)" />
                    <p class="margin-left-xs">
                      <mat-error class="hintErr" *ngIf="updateUserDataForm?.controls['tags'].errors?.pattern"
                        i18n="name Error|Explains name is required">
                        Only space and alphabets are supported
                      </mat-error>
                    </p>
                  </div>
                </div>
                <div class="right-input-div">
                  <button mat-raised-button type="button" [disabled]="!tags.value"
                    (click)="addActivity({input: tags, value: tags.value})"
                    class="btn-success btn-responsive btn-add-activity">
                    <span class="text-white" i18n>Add tag</span>
                  </button>
                </div>
                <mat-chip-list #chipListTags>
                  <mat-chip *ngFor="let tag of selectedtags" [selectable]="true" [removable]="true"
                    (removed)="removeActivity(tag)">
                    {{ tag }}
                    <mat-icon matChipRemove>cancel</mat-icon>
                  </mat-chip>
                </mat-chip-list>
                <!-- </mat-form-field> -->
              </div>
            </div>

            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/2" *ngIf="!isMdoAdmin">
                <label for="roles" class="margin-remove-bottom form-label required" i18n-aria-label
                  aria-label="Roles label" i18n="Role label|Label which explains the user to select the roles">
                  Role
                </label>
                <mat-selection-list id="roles" formControlName="roles" #roles class="roles-list">
                  <mat-list-option *ngFor="let role of rolesList" (click)="modifyUserRoles(role.roleName)"
                    [selected]="userRoles.has(role.roleName)" [value]="role?.roleName">
                    {{role.roleName}}
                  </mat-list-option>
                </mat-selection-list>
              </div>

              <div class="md:w-1/2" *ngIf="isMdoAdmin">
                <label class="view-text-label">Roles</label>
                <div *ngIf="user?.organisations && user?.organisations[0].roles.length > 0">
                  <ul class="roleslist">
                    <li *ngFor="let t of user?.organisations[0]?.roles">{{t}}
                    </li>
                  </ul>
                </div>
                <p *ngIf="user?.organisations && user?.organisations[0]?.roles.length === 0">-</p>
              </div>
            </div>

            <div class="flex flex-row margin-top-l">
              <button mat-raised-button type="submit" (click)="onSubmit(updateUserDataForm, user, panel)"
                class="margin-right-m btn-success btn-responsive successbtn" [disabled]="updateUserDataForm?.invalid">
                <span class="text-white" i18n>
                  Update
                </span>
              </button>
              <button mat-raised-button type="submit" (click)="cancelSubmit()"
                class="btn-success btn-responsive cancelbtn">
                <span i18n>
                  Cancel
                </span>
              </button>
            </div>
          </div>
        </form>
      </div>

      <div class="panel-body" *ngIf="!user?.enableEdit">
        <!-- <button mat-button class="my-4 mr-4" (click)="addRejection()">add reason</button>
        <button mat-button class="my-4 mr-4" (click)="updateRejection()">update reason</button> -->
        <div class="inner-body mat-body-2">
          <div class="margin-bottom-m">
            <span class="font-bold">Primary Details</span> <mat-icon
              class="ws-mat-black40-text infoicon">info_outline</mat-icon>
          </div>
          <div class="flex flex-row margin-top-m">
            <div class="md:w-1/3">
              <label class="view-text-label">Group</label>
              <p>{{user.profileDetails && user.profileDetails.additionalProperties &&
                user.profileDetails.additionalProperties.group ?
                user.profileDetails.additionalProperties.group : '-'}}
                <mat-icon class="verified-icon margin-left-xs"
                  *ngIf="user?.profileDetails?.profileStatus === 'VERIFIED'">
                  check_circle</mat-icon>
                <mat-icon class="nonverified-icon margin-left-xs"
                  *ngIf="user?.profileDetails?.profileStatus === 'NOT-VERIFIED'">
                  check_circle</mat-icon>
              </p>
            </div>
            <div class="md:w-1/3">
              <label class="view-text-label">Designation</label>
              <p>{{user.profileDetails && user.profileDetails.professionalDetails &&
                user.profileDetails.professionalDetails.designation ?
                user.profileDetails.professionalDetails.designation : '-'}}
                <mat-icon class="verified-icon margin-left-xs"
                  *ngIf="user?.profileDetails?.profileStatus === 'VERIFIED'">
                  check_circle</mat-icon>
                <mat-icon class="nonverified-icon margin-left-xs"
                  *ngIf="user?.profileDetails?.profileStatus === 'NOT-VERIFIED'">
                  check_circle</mat-icon>
              </p>
            </div>
          </div>
        </div>
        <hr>
        <div class="inner-body margin-top-m mat-body-2">
          <div class="margin-bottom-m">
            <span class="font-bold">Other Details</span> <mat-icon
              class="ws-mat-black40-text infoicon">info_outline</mat-icon>
          </div>

          <div class="flex flex-row margin-top-m">
            <div class="md:w-1/4">
              <label class="view-text-label">Employee ID</label>
              <p>{{user.profileDetails && user.profileDetails.employmentDetails &&
                user.profileDetails.employmentDetails.employeeCode ?
                user.profileDetails.employmentDetails.employeeCode : '-'}}</p>
            </div>

            <div class="md:w-1/4">
              <label class="view-text-label">Email</label>
              <p>{{user.profileDetails && user.profileDetails.personalDetails ?
                user.profileDetails.personalDetails.primaryEmail : '-'}}</p>
            </div>

            <div class="md:w-1/4">
              <label class="view-text-label">Mobile Number</label>
              <p>{{user.profileDetails && user.profileDetails.personalDetails ?
                user.profileDetails.personalDetails.mobile : '-'}}</p>
            </div>

            <div class="md:w-1/4">
              <label class="view-text-label">Gender</label>
              <p>{{user.profileDetails && user.profileDetails.personalDetails &&
                user.profileDetails.personalDetails.gender ?
                user.profileDetails.personalDetails.gender : '-'}}</p>
            </div>
          </div>
          <div class="flex flex-row margin-top-m">
            <div class="md:w-1/4">
              <label class="view-text-label">Date Of Birth</label>
              <p>{{user.profileDetails && user.profileDetails.personalDetails && user.profileDetails.personalDetails.dob
                ? user.profileDetails.personalDetails.dob
                : '-'}}</p>
            </div>

            <div class="md:w-1/4">
              <label class="view-text-label">Mother Tongue</label>
              <p>{{user.profileDetails && user.profileDetails.personalDetails &&
                user.profileDetails.personalDetails.domicileMedium ?
                user.profileDetails.personalDetails.domicileMedium : '-'}}</p>
            </div>

            <div class="md:w-1/4">
              <label class="view-text-label">Category</label>
              <p>{{user.profileDetails && user.profileDetails.personalDetails &&
                user.profileDetails.personalDetails.category ?
                user.profileDetails.personalDetails.category : '-'}}</p>
            </div>

            <div class="md:w-1/4">
              <label class="view-text-label">Pay Band</label>
              <p>{{user.profileDetails && user.profileDetails.employmentDetails &&
                user.profileDetails.employmentDetails.payType ?
                user.profileDetails.employmentDetails.payType : '-'}}</p>
            </div>
          </div>
          <div class="flex flex-row margin-top-m">
            <div class="md:w-1/4">
              <label class="view-text-label">Office Pin Code</label>
              <p>{{user.profileDetails && user.profileDetails.employmentDetails &&
                user.profileDetails.employmentDetails.pinCode ?
                user.profileDetails.employmentDetails.pinCode : '-'}}</p>
            </div>

            <div class="md:w-1/4">
              <label class="view-text-label">eHRMS ID</label>
              <p>{{user.ehrmsID ? user.ehrmsID : '-'}}</p>
            </div>

            <div class="md:w-1/2">
              <label class="view-text-label">Tags</label>
              <div *ngIf="user.profileDetails && user.profileDetails.additionalProperties &&
              user.profileDetails.additionalProperties.tag &&
              user.profileDetails.additionalProperties.tag.length > 0">
                <ul class="tagslist">
                  <li *ngFor="let t of user.profileDetails.additionalProperties.tag">{{t}}</li>
                </ul>
              </div>
              <p *ngIf="user.profileDetails && !user.profileDetails.additionalProperties">-</p>
            </div>
          </div>
          <div class="flex flex-row margin-top-m">
            <div class="md:w-1/1">
              <label class="view-text-label">Roles</label>
              <div *ngIf="user.organisations && user.organisations[0].roles.length > 0">
                <ul class="roleslist">
                  <li *ngFor="let t of user.organisations[0].roles">{{t}}
                  </li>
                </ul>
              </div>
              <p *ngIf="user.organisations && user.organisations[0].roles.length === 0">-</p>
            </div>
          </div>
        </div>
      </div>
    </mat-expansion-panel>
  </mat-accordion>

  <div *ngIf="usersData && usersData?.content.length === 0">
    <p class="margin-top-xl margin-bottom-xl">No users found</p>
  </div>
</div>

<!-- for Approvals page -->
<div *ngIf="isApprovals">
  <mat-accordion [multi]="true" *ngIf="approvalData">
    <mat-expansion-panel class="user-card" *ngFor="let appData of approvalData" #panel
      (opened)="closeOtherPanels(panel)">
      <mat-expansion-panel-header (click)="getUerData(appData.user, appData.userWorkflow);">
        <div class="float-left width82" (click)="$event.stopPropagation();">
          <div class="initialcircle display-inline-block margin-right-s" *ngIf="appData?.user">
            <ws-widget-avatar-photo [name]="getUseravatarName(appData?.user)" [photoUrl]="appData?.user?.photo"
              size="l">
            </ws-widget-avatar-photo>
          </div>
          <div class="initialcircle display-inline-block margin-right-s" *ngIf="!appData?.user">
            <ws-widget-avatar-photo [name]="appData?.userWorkflow?.userInfo?.first_name" [photoUrl]="" size="l">
            </ws-widget-avatar-photo>
          </div>
          <div class="username display-inline-block">
            <div class="mat-subheading-2 margin-remove">
              {{appData.userWorkflow.userInfo.first_name}}
            </div>
            <div class="mat-body-2 ws-mat-black40-text">{{appData.user &&
              appData.user.profileDetails.professionalDetails &&
              appData.user.profileDetails.professionalDetails.designation ?
              appData.user.profileDetails.professionalDetails.designation : '-'}}</div>
            <div class="mat-caption ws-mat-black40-text">Requested on: {{appData.requestedon | date: 'dd/MM/yyyy'}}
            </div>
          </div>
        </div>

        <div class="float-right">
          <p class="mat-body-2 margin-top-m margin-right-m"><mat-icon class="orangeicon">error</mat-icon>
            {{appData?.needApprovalList.length}} approval pending</p>
        </div>
      </mat-expansion-panel-header>

      <div class="panel-body">
        <form [formGroup]="approveUserDataForm" class="margin-top-m">
          <!-- <button mat-button class="my-4 mr-4" (click)="addRejection()">add reason</button>
              <button mat-button class="my-4 mr-4" (click)="updateRejection()">update reason</button> -->
          <div class="inner-body mat-body-2">
            <div class="margin-bottom-m">
              <span class="font-bold">Primary Details</span> <mat-icon
                class="ws-mat-black40-text infoicon">info_outline</mat-icon>
            </div>
            <div class="flex flex-row margin-top-m">
              <!-- <div class="md:w-1/3">
                <label class="view-text-label">Designation</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.professionalDetails &&
                  appData.user.profileDetails.professionalDetails.designation ?
                  appData.user.profileDetails.professionalDetails.designation : '-'}} <mat-icon
                    class="verified-icon">check_circle</mat-icon></p>
                <mat-radio-group aria-label="Select an option" name="approveDesignation"
                  formControlName="approveDesignation">
                  <mat-radio-button value="approve" class="margin-right-s">Approve</mat-radio-button>
                  <mat-radio-button value="reject" (click)="addRejection('designation')">Reject</mat-radio-button>
                </mat-radio-group>
              </div>

              <div class="md:w-1/3">
                <label class="view-text-label">Group</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.additionalProperties &&
                  appData.user.profileDetails.additionalProperties.group ?
                  appData.user.profileDetails.additionalProperties.group : '-'}} <mat-icon
                    class="verified-icon">check_circle</mat-icon>
                </p>

                <mat-radio-group aria-label="Select an option" name="approveGroup" formControlName="approveGroup">
                  <mat-radio-button value="approve" class="margin-right-s">Approve</mat-radio-button>
                  <mat-radio-button value="reject" (click)="addRejection('group')">Reject</mat-radio-button>
                </mat-radio-group>
              </div> -->
              <ng-container *ngFor="let field of appData.needApprovalList">
                <div class="md:w-1/3 margin-bottom-s" *ngIf="field.label === 'Group'">
                  <label class="view-text-label">Group</label>
                  <div>
                    <span>
                      <input type="text" class="appr-text-field margin-bottom-s" [value]="field.value">
                      <mat-icon class="verified-icon margin-left-s"
                        *ngIf="field.action === 'APPROVE'">check_circle</mat-icon>
                      <mat-icon class="nonverified-icon margin-left-s"
                        *ngIf="field.action === 'REJECT'">cancel</mat-icon>
                    </span>
                    <mat-radio-group aria-label="Select an option" name="approveGroup" formControlName="approveGroup"
                      class="mat-caption margin-top-s">
                      <mat-radio-button value="approvegroup" class="margin-right-s"
                        (click)="onClickHandleWorkflow(field,'APPROVE')">Approve</mat-radio-button>
                      <mat-radio-button value="rejectgroup"
                        (click)="onClickHandleWorkflow(field,'REJECT')">Reject</mat-radio-button>
                      <mat-icon class="margin-left-m editreasonicon cursor-pointer"
                        *ngIf="field.action === 'REJECT' && comment !== ''"
                        (click)="updateRejection(field)">chat_bubble</mat-icon>
                    </mat-radio-group>
                  </div>
                </div>
                <div class="md:w-1/3 margin-bottom-s" *ngIf="field.label === 'Designation'">
                  <label class="view-text-label">Designation</label>
                  <div>
                    <span>
                      <input type="text" class="appr-text-field margin-bottom-s" [value]="field.value">
                      <mat-icon class="verified-icon margin-left-s"
                        *ngIf="field.action === 'APPROVE'">check_circle</mat-icon>
                      <mat-icon class="nonverified-icon margin-left-s"
                        *ngIf="field.action === 'REJECT'">cancel</mat-icon>
                    </span>
                    <mat-radio-group aria-label="Select an option" name="approveDesignation"
                      formControlName="approveDesignation" class="mat-caption margin-top-s">
                      <mat-radio-button value="approvedesg" class="margin-right-s"
                        (click)="onClickHandleWorkflow(field,'APPROVE')">Approve</mat-radio-button>
                      <mat-radio-button value="rejectdesg"
                        (click)="onClickHandleWorkflow(field,'REJECT')">Reject</mat-radio-button>
                      <mat-icon class="margin-left-m editreasonicon cursor-pointer"
                        *ngIf="field.action === 'REJECT' && comment !== ''"
                        (click)="updateRejection(field)">chat_bubble</mat-icon>
                    </mat-radio-group>
                  </div>
                </div>
              </ng-container>
            </div>
          </div>
          <hr>
          <div class="inner-body margin-top-m mat-body-2" *ngIf="appData?.user">
            <div class="margin-bottom-m">
              <span class="font-bold">Other Details</span> <mat-icon
                class="ws-mat-black40-text infoicon">info_outline</mat-icon>
            </div>

            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/4">
                <label class="view-text-label">Employee ID</label>
                <p>{{appData.user.empID ? appData.user.empID : '-'}}</p>
              </div>

              <div class="md:w-1/4">
                <label class="view-text-label">Email</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.personalDetails ?
                  appData.user.profileDetails.personalDetails.primaryEmail : '-'}}</p>
              </div>

              <div class="md:w-1/4">
                <label class="view-text-label">Mobile Number</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.personalDetails ?
                  appData.user.profileDetails.personalDetails.mobile : '-'}}</p>
              </div>

              <div class="md:w-1/4">
                <label class="view-text-label">Gender</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.personalDetails &&
                  appData.user.profileDetails.personalDetails.gender ?
                  appData.user.profileDetails.personalDetails.gender : '-'}}</p>
              </div>
            </div>
            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/4">
                <label class="view-text-label">Date Of Birth</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.personalDetails &&
                  appData.user.profileDetails.personalDetails.dob
                  ? appData.user.profileDetails.personalDetails.dob
                  : '-'}}</p>
              </div>

              <div class="md:w-1/4">
                <label class="view-text-label">Mother Tongue</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.personalDetails &&
                  appData.user.profileDetails.personalDetails.domicileMedium ?
                  appData.user.profileDetails.personalDetails.domicileMedium : '-'}}</p>
              </div>

              <div class="md:w-1/4">
                <label class="view-text-label">Category</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.personalDetails &&
                  appData.user.profileDetails.personalDetails.category ?
                  appData.user.profileDetails.personalDetails.category : '-'}}</p>
              </div>

              <div class="md:w-1/4">
                <label class="view-text-label">Pay Band</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.employmentDetails &&
                  appData.user.profileDetails.employmentDetails.payType ?
                  appData.user.profileDetails.employmentDetails.payType : '-'}}</p>
              </div>
            </div>
            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/4">
                <label class="view-text-label">Office Pin Code</label>
                <p>{{appData.user.profileDetails && appData.user.profileDetails.employmentDetails &&
                  appData.user.profileDetails.employmentDetails.pinCode ?
                  appData.user.profileDetails.employmentDetails.pinCode : '-'}}</p>
              </div>

              <div class="md:w-1/4">
                <label class="view-text-label">eHRMS ID</label>
                <p>{{appData.user.ehrmsID ? appData.user.ehrmsID : '-'}}</p>
              </div>

              <div class="md:w-1/2">
                <label class="view-text-label">Tags</label>
                <div *ngIf="appData?.user?.profileDetails && appData?.user?.profileDetails?.additionalProperties &&
                    appData?.user?.profileDetails?.additionalProperties?.tag &&
                    appData?.user?.profileDetails?.additionalProperties?.tag.length > 0">
                  <ul class="tagslist">
                    <li *ngFor="let t of appData?.user?.profileDetails?.additionalProperties.tag">{{t}}</li>
                  </ul>
                </div>
                <p *ngIf="appData?.user?.profileDetails && !appData?.user?.profileDetails?.additionalProperties">-</p>
              </div>
            </div>
            <div class="flex flex-row margin-top-m">
              <div class="md:w-1/1">
                <label class="view-text-label">Roles</label>
                <div *ngIf="appData?.user?.organisations && appData?.user?.organisations[0]?.roles.length > 0">
                  <ul class="roleslist">
                    <li *ngFor="let t of appData?.user?.organisations[0]?.roles">{{t}}
                    </li>
                  </ul>
                </div>
                <p *ngIf="appData?.user?.organisations && appData?.user?.organisations[0].roles.length === 0">-</p>
              </div>
            </div>
          </div>

          <div class="panel-body" *ngIf="!appData?.user">
            <p class="text-center margin-top-m">No user data</p>
          </div>

          <div class="flex flex-row margin-top-l">
            <button mat-raised-button type="submit" (click)="onApprovalSubmit(panel)"
              class="margin-right-m btn-success btn-responsive successbtn" [disabled]="!approveUserDataForm.valid">
              <span class="text-white" i18n>
                Update
              </span>
            </button>
            <button mat-raised-button type="submit" (click)="onApprovalCancel()"
              class="btn-success btn-responsive cancelbtn">
              <span i18n>
                Cancel
              </span>
            </button>
          </div>
        </form>
      </div>
    </mat-expansion-panel>
  </mat-accordion>

  <div *ngIf="!approvalData">
    <p class="margin-top-xl margin-bottom-xl">No approval requests</p>
  </div>
</div>

<div class="flex flex-row justify-center">
  <mat-paginator [pageSize]="pageSize" [length]="totalRecords" [pageSizeOptions]="[20,30,40]"
    (page)="onChangePage($event)"></mat-paginator>
</div>

<ng-template #rejectDialog>
  <form class="rejectdialog">
    <p mat-dialog-title class="dialog-title">Reason for rejection</p>
    <mat-dialog-content>
      <mat-form-field class="w-full mt-5" appearance="outline">
        <textarea matInput class="reason-text-area" [(ngModel)]="comment" name="reason"
          placeholder="Type the description in fewer than 100 characters" i18n-placeholder resizable="none"></textarea>
      </mat-form-field>
    </mat-dialog-content>
    <mat-dialog-actions class="flex flex-wrap justify-end">
      <button mat-raised-button class="btn-success btn-responsive successbtn" [mat-dialog-close]="true"
        [disabled]="!comment">
        <span class="text-white">Submit</span></button>
      <button mat-raised-button class="btn-success btn-responsive cancelbtn" matDialogClose>Cancel</button>
    </mat-dialog-actions>
  </form>
</ng-template>

<ng-template #updaterejectDialog>
  <form class="rejectdialog">
    <p mat-dialog-title class="dialog-title">Reason for rejection
      <mat-icon (click)="showedit()" *ngIf="!showeditText" class="float-right cursor-pointer">edit_square</mat-icon>
    </p>
    <mat-dialog-content>
      <p class="margin-top-l margin-bottom-l" *ngIf="!showeditText">{{comment}}</p>
      <mat-form-field class="w-full mt-5" appearance="outline" *ngIf="showeditText">
        <textarea matInput class="reason-text-area" [(ngModel)]="comment" name="reason"
          placeholder="Type the description in fewer than 100 characters" i18n-placeholder resizable="none"></textarea>
      </mat-form-field>
    </mat-dialog-content>
    <mat-dialog-actions class="flex flex-wrap justify-end" *ngIf="showeditText">
      <button mat-raised-button class="btn-success btn-responsive successbtn" [mat-dialog-close]="true">
        <span class="text-white">Update</span></button>
      <button mat-raised-button class="btn-success btn-responsive cancelbtn" matDialogClose>Cancel</button>
    </mat-dialog-actions>
  </form>
</ng-template>